!!! 5
%html{:lang => I18n.locale.to_s}
  %head
    %meta{:charset => "utf-8"}/
    %title= strip_tags( content_for?(:title) ? yield(:title) : "WAT (dev &alpha;)" )
    = csrf_meta_tags
    / Le HTML5 shim, for IE6-8 support of HTML elements
    /[if lt IE 9]
      = javascript_include_tag "http://html5shim.googlecode.com/svn/trunk/html5.js"
    / Le styles
    :css
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    -# Test without this -> rspec message: undefined|0|ReferenceError: Can't find variable: google
    - if Rails.env == 'test'
      = javascript_include_tag "application"
      = javascript_include_tag "http://maps.googleapis.com/maps/api/js?sensor=false"
    - else
      -# Google-Maps does not work when defined on last row!!
      - if params[:controller] == "users"
        = javascript_include_tag "application"
        = javascript_include_tag "http://maps.googleapis.com/maps/api/js?sensor=false"
    = stylesheet_link_tag "application", :media => "all"
    / Le fav and touch icons
    %link{:href => "/images/favicon.ico", :rel => "shortcut icon"}/
    %link{:href => "/images/apple-touch-icon.png", :rel => "apple-touch-icon"}/
    %link{:href => "/images/apple-touch-icon-72x72.png", :rel => "apple-touch-icon", :sizes => "72x72"}/
    %link{:href => "/images/apple-touch-icon-114x114.png", :rel => "apple-touch-icon", :sizes => "114x114"}/
    %meta{:name=>"viewport", :content=>"width=device-width, initial-scale=1.0"}


  %body
    .navbar.navbar-fixed-top
      .navbar-inner
        .container
          %a.btn.btn-navbar{"data-target" => ".nav-collapse", "data-toggle" => "collapse"}
            %span.icon-bar
            %span.icon-bar
            %span.icon-bar
          %a.brand{:href => (root_url + "#")}= (Settings.application_brand || "Please set application_brand in settings").html_safe
          .container.nav-collapse
            %ul.nav
              %li= link_to 'README', page_path('readme')
            = yield(:search_bar) if content_for?(:search_bar)
            = render 'shared/navigation'
    
    .container.main
      - if content_for?(:top_menu)
        %div=content_for(:top_menu)
      - if flash.any?
        .row-fluid
          .span12
            - flash.each do |type,msg|
              .alert{:class => "alert alert-#{flash_alert(type)}"}
                = close_icon 
                %strong= flash_title(type).html_safe
                %br/
                = msg
      .row-fluid
        - if content_for?(:content_menu)
          .span9= yield
          .span3
            .sidebar-nav
              %h1 &nbsp;
              %ul.well.nav.nav-list
                = yield(:content_menu)
        - else
          .span12
            = yield
            
      
    %footer
      %div{style: "text-align: center"}
        = render 'shared/copyright'
        &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
        = render 'shared/language_selection'
        &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
        = render 'shared/footer_right'
        
    /
      Le javascript
      \==================================================
    / Placed at the end of the document so the pages load faster
    - if Rails.env != 'test'
      - if params[:controller] != "users"
        = javascript_include_tag "application"
